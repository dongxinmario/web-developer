<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>promise.all</title>
  </head>
  <body>
    <script>
      /* 
    Promise.all 方法可以把多个 promise 实例 包装成一个新的 promise 实例
    Promise.all([ promise1, promise2, ]) : Promise
    模拟需要多个请求的数据 才能进行下一步操作的情况
    */
      function getData1() {
        return new Promise((resolve, reject) => {
          setTimeout(() => {
            console.log('第一条数据加载成功')
            resolve('data1')
          }, 1000)
        })
      }
      function getData2() {
        return new Promise((resolve, reject) => {
          setTimeout(() => {
            console.log('第二条数据加载成功')
            resolve('data2')
          }, 1000)
        })
      }
      function getData3() {
        return new Promise((resolve, reject) => {
          setTimeout(() => {
            console.log('第三条数据加载成功')
            resolve('data3')
          }, 1000)
        })
      }
      function getData4() {
        return new Promise((resolve, reject) => {
          setTimeout(() => {
            // console.log('第四条数据加载成功')
            reject('data4 error')
          }, 500)
        })
      }
      let p = Promise.all([getData1(), getData2(), getData3(), getData4()])
      p.then(
        (arr) => {
          console.log(arr)
        },
        (e) => {
          console.log(e)
        }
      )
      // 不使用 Promise.all
      /* let count = 0
      function func() {
        if (count < 4) return
        console.log('全部拿到了')
      }
      function getData1() {
        setTimeout(() => {
          console.log('第一条数据加载成功')
          count++
          func()
        }, 1000)
      }
      function getData2() {
        setTimeout(() => {
          console.log('第二条数据加载成功')
          count++
          func()
        }, 1000)
      }
      function getData3() {
        setTimeout(() => {
          console.log('第三条数据加载成功')
          count++
          func()
        }, 1000)
      }
      function getData4() {
        setTimeout(() => {
          console.log('第四条数据加载成功')
          count++
          func()
        }, 1000)
      }
      getData1()
      getData2()
      getData3()
      getData4() */
    </script>
  </body>
</html>
